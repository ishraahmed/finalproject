
<div class="container-fluid" *ngIf="isMember==0" >
    <h2 style="color:black">this user is not part of this project</h2>
    </div>

<div *ngIf="isMember!=0" class="container-fluid">
    <div  class="row">
            
        <div style=" margin-left:-20px; margin-right:20px; height:555px;  overflow-y:auto;" class="col-lg-6">
                <h4>Project backlog</h4>
                <div class="panel-group">
                        <div *ngFor="let item of userStory; index as i; " class="panel panel-info">
                          <div class="panel-heading">
                              <div class="dropdown">
  <span class="glyphicon glyphicon-option-vertical"  data-toggle="dropdown"></span>  {{item['title']}}
  <p style="float:right"> state: {{item['state']}} </p>
  <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
        <!-- <li><a data-toggle="modal" data-target="#userstoryModal" id="{{item['us_id']}}" (click)="editUs($event)" ><span class="glyphicon glyphicon-pencil" > </span>  Edit</a></li> -->
        <li><a id="{{item['us_id']}}"  (click)="UsDelete($event)"><span class="	glyphicon glyphicon-remove" id="{{item['us_id']}}"  (click)="UsDelete($event)" > </span>  Delete</a></li>
        <li class="divider"></li>
        <li class="dropdown-submenu">
          <a tabindex="-1" href="#">Move to iteration</a>
          <ul class="dropdown-menu">
            <li ><a *ngFor="let itemm of iterations"  tabindex="-1" id="{{item['us_id']}}"  (click)="UsIteration($event)" >{{itemm['title']}}</a></li>
<!-- 
            <li><a href="#">Second level</a></li>
            <li><a href="#">Second level</a></li> -->
          </ul>
        </li>
      </ul>
</div>
                     
                              
                          </div>
                          <div class="panel-body">
                                <div class="panel panel-default">
                                        <div style="padding:4px;padding-left:10px; " class="panel-body">
                                                <div class="row">
                                    
                                                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" >
                                                             <label style="float:left; color: gray">Assigned to: {{item['assigned_to']}}</label>
                                                        
                                                        </div>
                                                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" >
                                                             <label style="float:left;color: gray">Iteration: {{item['iteration']}}</label>
                                                        
                                                        </div>
                                                     </div>
                                        </div>
                                      </div>
                         <br>
                             
                                 <a id="{{item['us_id']}}" data-toggle="modal" data-target="#taskModal" (click)="getUsid($event)"> <span  class="glyphicon glyphicon-plus"></span>
                                Add Task 
                                 </a>
                                    <br>
                                <a data-toggle="collapse"  [attr.data-target] ="'#cl'+ item['us_id']"> <span class="glyphicon glyphicon-chevron-right"> </span>View Tasks
                                </a>
                                <br>
                                <br>
                                <div id="cl{{item['us_id']}}" class="collapse">
                                        <div *ngFor="let ii of item['tasks']" class="panel-group">
                                                <div class="panel panel-success">
                                                        <div class="panel-heading">
                                                                <div class="dropdown">
                                                                        <span class="glyphicon glyphicon-option-vertical"  data-toggle="dropdown"></span>  {{ii['title']}}
                                                                        <p style="float:right"> state: {{ii['state']}} </p> <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                                              <li><a id="{{item['us_id']}}.{{ii['task_id']}}" data-toggle="modal" data-target="#taskModal" (click)="TaskEdit($event)"><span class="glyphicon glyphicon-pencil"> </span>  Edit</a></li>
                                                                              <li ><a id="{{item['us_id']}}.{{ii['task_id']}}"  (click)="TaskDelete($event)"><span class="	glyphicon glyphicon-remove"> </span>  Delete</a></li>
                                                                              <li class="divider"></li>
                                                                              <li class="dropdown-submenu">
                                                                                <a tabindex="-1" href="#">Move to iteration</a>
                                                                                <ul class="dropdown-menu">
                                                                                  <li ><a *ngFor="let itemm of iterations"  tabindex="-1" id="{{item['us_id']}}.{{ii['task_id']}}"  (click)="TaskIteration($event)" >{{itemm['title']}}</a></li>
                                                                      <!-- 
                                                                                  <li><a href="#">Second level</a></li>
                                                                                  <li><a href="#">Second level</a></li> -->
                                                                                </ul>
                                                                              </li>
                                                                            </ul>
                                                                      </div>
                                                                
                                                       </div>
                                                        <div style="height:auto; padding:5px;" class="panel-body">
                                                                <div >
                                                                        <div style="padding:4px;padding-left:10px; " class="panel-body">
                                                                                <div class="row">
                                                                    
                                                                                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" >
                                                                                             <label style="float:left; color: gray">Assigned to: {{ii['assigned_to']}}</label>
                                                                                        
                                                                                        </div>
                                                                                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" >
                                                                                             <label style="float:left;color: gray">Iteration: {{ii['iteration']}}</label>
                                                                                        
                                                                                        </div>
                                                                                     </div>
                                                                        </div>
                                                                      </div>
                                                           </div>
                                                      </div>
                                               
                                               
                                        </div>
                                </div>
                          </div>
                        </div>
                        
                      </div>
                <!-- <button  type="button" class="btn btn-success" data-toggle="modal1" data-target="#myModal1"> <span class="glyphicon glyphicon-plus"></span>Add User Story </button>
              -->
                
    </div>
        <div style="overflow-y: auto; height:555px; " class="col-lg-6">
                <h3>Planning</h3>
                <div style=" padding-top: 20px;">
            <div style="padding:5px; " class="card">
              
               
                  <a><h4 class="card-title" (click)="backlog()" > Project Backlog</h4></a>
                   </div>
                   
               
                   <div *ngFor="let item of sprints" style="padding:5px; " class="card">
              
               
                        <a ><h4 id="{{item['title']}}" (click)="sprintClick($event)" style="float:left;"> {{item['title']}}</h4></a>
                        <h6 style="float:right;"> {{item['startDate']}} to {{item['endDate']}} </h6>
                        <h6> total days : {{item['days']}} </h6>
                   </div>
                         <button style="margin-bottom:10px;" type="button" class="btn btn-success" data-toggle="modal" data-target="#myModal"> <span class="glyphicon glyphicon-plus"></span>Add Sprint </button>
                   
             
         
         
        </div>
    </div>
      </div>
</div>
<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
  
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <form name="form" (ngSubmit)="f.form.valid && onSubmit();" #f="ngForm" novalidate>
        <div class="modal-body">
          
       
          <div class="form-group">
            <label for="Username"><mark style="background-color:white;color:red;">*</mark> Title</label>
            <input type="text" class="form-control" name="title" [(ngModel)]="model.title" #title="ngModel" [ngClass]="{ 'is-invalid': f.submitted && title.invalid }" required  />
            <div *ngIf="f.submitted && title.invalid" class="invalid-feedback">
                <div style="color:red;" *ngIf="title.errors.required">Title is required</div>
                <!-- <div style="color:red;" *ngIf="email.errors.email">Email must be a valid email address</div> -->
            </div>
        </div>

        <div class="form-group">
            <label for="startDate"><mark style="background-color:white;color:red;">*</mark> Start Date</label>
            <input type="date" class="form-control" name="startDate" [(ngModel)]="model.startDate" #startDate="ngModel" [ngClass]="{ 'is-invalid': f.submitted && startDate.invalid }" required  />
            <div *ngIf="f.submitted && startDate.invalid" class="invalid-feedback">
                <div style="color:red;" *ngIf="startDate.errors.required">Start date is required</div>
                <!-- <div style="color:red;" *ngIf="email.errors.email">Email must be a valid email address</div> -->
            </div>
        </div>
        <div class="form-group">
            <label for="endDate"><mark style="background-color:white;color:red;">*</mark> Title</label>
            <input type="date" class="form-control" name="endDate" [(ngModel)]="model.endDate" #endDate="ngModel" [ngClass]="{ 'is-invalid': f.submitted && endDate.invalid }" required  />
            <div *ngIf="f.submitted && endDate.invalid" class="invalid-feedback">
                <div style="color:red;" *ngIf="endDate.errors.required">End date is required</div>
                <!-- <div style="color:red;" *ngIf="email.errors.email">Email must be a valid email address</div> -->
            </div>
        </div>
        
        
        </div>
        <div class="modal-footer">
            <button type="submit" class="btn btn-success"  >Save</button>
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
      </form>
      </div>
    </div>
</div>

<div id="taskModal" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg">
      
                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header" style="background-color: 	  #428bca">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 style="color:#0B0B3B ;" class="modal-title"><span style="color:#0B0B3B;" class="glyphicon glyphicon-list-alt"></span> {{taskModalHeader}}</h4>
                  </div>
            
                 <form name="form" (ngSubmit)="ff.form.valid && saveTask();" id="myForm" #ff="ngForm" novalidate>

                  <div style="overflow: auto;" class="modal-body">
                     <div *ngIf="taskEdit==0;" class="form-group">
                            <label for="title"><mark style="background-color:white;color:red;">*</mark> Title</label>
                            <input style="width:50%; display:inline; margin-left: 50px; " id="Etitle" type="text" class="form-control" name="title" [(ngModel)]="model.title" #title="ngModel" [ngClass]="{ 'is-invalid': ff.submitted && title.invalid }" required  />
                           
                            <div *ngIf="ff.submitted && title.invalid" class="invalid-feedback">
                                <div style="color:red;" *ngIf="title.errors.required">Title is required</div>
                                <!-- <div style="color:red;" *ngIf="email.errors.email">Email must be a valid email address</div> -->
                            </div>
                        </div>
                        <div *ngIf="taskEdit==1;" class="form-group">
                                <label for="title"><mark style="background-color:white;color:red;">*</mark> Title</label>
                                <input style="width:50%; display:inline; margin-left: 50px; " id="Etitle" type="text" class="form-control" name="title" [(ngModel)]="model.title" #title="ngModel" [ngClass]="{ 'is-invalid': ff.submitted && title.invalid }"  />                           
                        </div>  
                    <!-- <label style="float:left;">Title</label>
                    <input id="Updatedtitle" class="form-control" style="float:left; width:50%; margin-left: 63px;"  /> -->
               
                 <div class="form-group">
                       <label style=" display: block;clear: both; float:left;">assigned to: </label>
                       <input id="assigned" style=" display: block; width:50%; margin-left:  10px; float:left;" pattern="[a-zA-Z]+\s\s\({1}[a-zA-Z]{1}\.[a-zA-Z0-9]+[0-9]+\){1}" type="text" class="form-control" name="assigned" list="browsers" [(ngModel)]="model.assigned" #assigned="ngModel" [ngClass]="{ 'is-invalid': ff.submitted && assigned.invalid }"  />
                        
                        <datalist id="browsers">
                            <option *ngFor="let item of emp" value="{{item['name']}}({{item['username']}})" ></option>                  
                        </datalist>
                        <div *ngIf="assignmentError==1">
                        <br>
                        <br>
                        <p style="clear: both;"style="color:red;">please select from the list</p>
                      </div>
                        <div style="clear:both" *ngIf="ff.submitted && assigned.invalid" class="invalid-feedback">
                            <div style="color:red;" *ngIf="assigned.errors.pattern">please select from the list</div>
                       </div>
                    </div>

                    <div class="form-group">
                            
                            <label style=" display: block;clear: both; float:left;  margin-top: 10px;">state: </label>
                            <select  id="state" name="state" [(ngModel)]="model.state" #state="ngModel" class="form-control"  style=" display: block; margin-left: 10px; float:left; margin-top: 10px; width: 200px;">
                                  <option selected="selected" value="New" >New</option>
                                  <option value="In Progress">In Progress</option>
                                  <option value="Completed">Completed</option>
                                  <option value="Accepted">Accepted</option>
                                  <option value="deleted">Deleted</option>
                                </select>
                         </div>
                     
                   
                    <div class="form-group">
      
                    <label style=" display: block; float:left; margin-left: 20px;  margin-top: 10px;">Iteration: </label>
                    <input class="form-control" (click)="iterationClick()" [(ngModel)]="model.iteration" id="iteration" #iteration="ngModel" style=" display: block;   margin-left: 10px; float:left; margin-top: 10px; width: 200px;" list="browsers2" id="iteration" name="browser">
                    <datalist id="browsers2"  >
                      <option *ngFor="let item of iterations" value="{{item['title']}}">               
                    </datalist>
                    
                    <div style="clear: both;" *ngIf="iterationError==1">
                    
                      <p style="color:red;">please select from the list</p>
                    </div>                  
                    </div>

                    <!-- <button style="float: right; margin-top: 10px; margin-left:10px;" class="btn btn-warning" (click)="history($event)" id="history">history</button>   
                     -->
                    <button style="float: right; margin-top: 10px;"class="btn btn-info" (click)="details($event)" id="details" >details</button>
                 
                    <!-- <input style="float:left; margin-left: 10px;" type="submit"> -->
                    <div  id="divdetails" >
                    <div style="float:left; width:70%; margin-top: 20px;">
                   <div style="clear:both;" >
                          <div class="panel panel-info">
                                  <div style="height:40px;" class="panel-heading">
                                          <label style="clear:both; float:left;">Description</label>
                                  </div>
                                  <div class="panel-body">
                                          <div style="clear:both;" id="collapseExample">
                                              
                                                  <textarea  style="width:100%;height:100px;" id="description" [(ngModel)]="model.description" name="description" #description="ngModel"></textarea>
                                                
                                                </div>
                                  </div>
                                </div>
                          
                                 
                      </div>
      
                          
                      </div>
                      <div style=" margin-left: 72%; ">
                          <div style=" float: left; margin-top: 20px; width:100%;">
                                  <div class="panel panel-info">
                                          <div class="panel-heading" style="height:40px; ">
                                                  <label style="float:left; " >Planning</label>
                                                  <a id="arrowup3" (click)="arrowup3()" style=" margin-left:10px;float:left;display: none;" data-toggle="collapse" href="#collapseExample2" role="button" aria-expanded="false" aria-controls="collapseExample1"><span class="glyphicon glyphicon-chevron-up"></span></a>
                                                  <a id="arrowdown3" (click)="arrowdown3()" style=" margin-left:10px;float:left; " data-toggle="collapse" href="#collapseExample2" role="button" aria-expanded="false" aria-controls="collapseExample1"><span class="glyphicon glyphicon-chevron-down"></span></a>
                                          </div>
                                          <div class="panel-body">
                                                  <div style="clear:left;margin-top:0px;" class="collapse" id="collapseExample2">
                                                          <div  >
                                                          <label style="float:left; text-align: left;">priority</label>
                                                          <select class="form-control" id="priority" [(ngModel)]="model.priority" name="priority" #priority="ngModel" >
                                                                <option value="1">1</option>
                                                                <option value="2">2</option>
                                                                <option value="3">3</option>
                                                                <option value="4">4</option>
                                                              </select>
                                                          </div>
                                                        </div>
                                          </div>
                                        </div>
                              
      
                                  
                          </div>
                             
                                  
                          </div>

                          <div style=" margin-left: 72%; ">
                                <div style=" float: left;width:100%;">
                                        <div class="panel panel-info">
                                                <div class="panel-heading" style="height:40px; ">
                                                        <label style="float:left; ">Effort(hours)</label>
                                                        <a id="arrowup3" (click)="arrowup3()" style=" margin-left:10px;float:left;display: none;" data-toggle="collapse" href="#collapseExample3" role="button" aria-expanded="false" aria-controls="collapseExample1"><span class="glyphicon glyphicon-chevron-up"></span></a>
                                                        <a id="arrowdown3" (click)="arrowdown3()" style=" margin-left:10px;float:left; " data-toggle="collapse" href="#collapseExample3" role="button" aria-expanded="false" aria-controls="collapseExample1"><span class="glyphicon glyphicon-chevron-down"></span></a>
                                                </div>
                                                <div class="panel-body">
                                                        <div style="clear:left;margin-top:0px;" class="collapse" id="collapseExample3">
                                                                <div  >
                                                                <label style="float:left;text-align: left;">Original Estimate</label>
                                                                <input id="original_estimate"  class="form-control" type="number" [(ngModel)]="model.OriginalEstimate" name="OriginalEstimate" #OriginalEstimate="ngModel" />
                                                                <label style="float:left;text-align: left;">Remaining</label>
                                                                <input id="remaining"  class="form-control" type="number"[(ngModel)]="model.RemainingTime" name="RemainingTime" #RemainingTime="ngModel" />
                                                                <label style="float:left;text-align: left;">Completed</label>
                                                                <input id="completed"  class="form-control" type="number" [(ngModel)]="model.CompletedTime" name="CompletedTime" #CompletedTime="ngModel" />
                                                                </div>
                                                              </div>
                                                </div>
                                              </div>
                                    
            
                                        
                                </div>
                                   
                                        
                                </div>
                          </div>
                      <!-- <div style="clear:both;float:left;margin-top: 10px; display:none;" id="divhistory" >sdnnhsv</div>
          -->
                  </div>
            
                  <div class="modal-footer">
                    <button type="submit" class="btn btn-success"   >Save</button>
                 <button (click)="myForm.reset()" data-dismiss="modal" class="btn btn-danger" >close</button>
                  </div>
                </form>
                </div>
            
              </div>

</div>


